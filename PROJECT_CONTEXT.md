# üìã –ü–û–õ–ù–´–ô –ö–û–ù–¢–ï–ö–°–¢ –ü–†–û–ï–ö–¢–ê: Advertising Marketplace Platform

## üéØ –û–ü–ò–°–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê

**Advertising Marketplace Platform** ‚Äî –¥–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω—è—è B2B –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, —Å–æ–µ–¥–∏–Ω—è—é—â–∞—è:
- **–ü—Ä–æ–¥–∞–≤—Ü–æ–≤ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤** (Wildberries, Ozon, Yandex.Market)
- **–í–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤** (VK, Telegram, Pinterest, Instagram, TikTok)

**–ë–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å**: –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–∏—Å—Å–∏—é 5-15% —Å —É—Å–ø–µ—à–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

**–°—Ç–∞—Ç—É—Å**: MVP (Phase 1) + Phase 2 (WebSocket, Email, Background Tasks) ‚Äî **–ó–ê–í–ï–†–®–ï–ù**

---

## üõ† –¢–ï–•–ù–û–õ–û–ì–ò–ß–ï–°–ö–ò–ô –°–¢–ï–ö

### Backend
- **Python 3.10.11** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- **FastAPI** ‚Äî REST API
- **Socket.io** (python-socketio) ‚Äî WebSocket –¥–ª—è real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **Supabase** (PostgreSQL) ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Pydantic** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Passlib[bcrypt]** ‚Äî —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- **JWT** ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (access + refresh tokens)
- **SendGrid** ‚Äî email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **APScheduler** ‚Äî —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
- **Redis** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **Jinja2** ‚Äî —à–∞–±–ª–æ–Ω—ã email

### Frontend
- **Next.js 15** (App Router, TypeScript, SSR)
- **React 18** (hooks, suspense)
- **TailwindCSS** ‚Äî —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è
- **Shadcn/ui** ‚Äî UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **Zustand** ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (auth)
- **TanStack Query (React Query)** ‚Äî data fetching
- **Socket.io-client** ‚Äî WebSocket –∫–ª–∏–µ–Ω—Ç
- **React Hook Form + Zod** ‚Äî —Ñ–æ—Ä–º—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **Axios** ‚Äî HTTP –∫–ª–∏–µ–Ω—Ç —Å JWT interceptors
- **react-hot-toast** ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **date-fns** ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç
- **lucide-react** ‚Äî –∏–∫–æ–Ω–∫–∏
- **Recharts** ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ (–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å)

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

```
Advertising Marketplace Platform/
‚îú‚îÄ‚îÄ app/                          # Backend (FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py           # Supabase –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ websocket.py          # Socket.io —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ scheduler.py          # –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_service.py       # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ seller_service.py     # –ü—Ä–æ–¥–∞–≤—Ü—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ channel_service.py   # –ö–∞–Ω–∞–ª—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ campaign_service.py  # –ö–∞–º–ø–∞–Ω–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payment_service.py   # –ü–ª–∞—Ç–µ–∂–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ review_service.py     # –û—Ç–∑—ã–≤—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin_service.py     # –ê–¥–º–∏–Ω–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ email_service.py     # Email (SendGrid)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ notification_service.py  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ routers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sellers.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ channels.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ campaigns.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payments.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reviews.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin.py
‚îÇ   ‚îú‚îÄ‚îÄ schemas/                  # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ config.py                 # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (Pydantic Settings)
‚îÇ   ‚îî‚îÄ‚îÄ templates/emails/         # HTML —à–∞–±–ª–æ–Ω—ã email
‚îú‚îÄ‚îÄ frontend/                     # Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/                  # App Router —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (auth)/           # Auth routes (login, register)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (seller)/         # Seller routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (channel)/        # Channel owner routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ (admin)/          # Admin routes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forms/            # –§–æ—Ä–º—ã (Login, Register, Campaign, etc.)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ campaigns/        # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–∞–º–ø–∞–Ω–∏–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ channels/        # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–∞–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/           # –ê–¥–º–∏–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payments/        # –ü–ª–∞—Ç–µ–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout/          # Header, Footer
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ common/          # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/             # API –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ store/           # Zustand stores
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types.ts         # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ socket.ts        # WebSocket –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils.ts         # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ formatting.ts    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validators.ts    # Zod —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ constants.ts    # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ hooks/               # Custom hooks
‚îÇ   ‚îú‚îÄ‚îÄ public/                   # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.ts
‚îÇ   ‚îî‚îÄ‚îÄ next.config.ts
‚îú‚îÄ‚îÄ main.py                       # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îú‚îÄ‚îÄ requirements.txt              # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                          # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å!)
‚îú‚îÄ‚îÄ .env.example                  # –ü—Ä–∏–º–µ—Ä .env
‚îú‚îÄ‚îÄ supabase_migrations.sql       # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ README.md

```

---

## üîß –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ò –ó–ê–ü–£–°–ö

### Backend

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**:
```bash
cd "Advertising Marketplace Platform"
python3.10 -m venv venv
source venv/bin/activate  # –∏–ª–∏ `venv\Scripts\activate` –Ω–∞ Windows
pip install -r requirements.txt
```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ `.env`** (—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ `.env.example`):
```env
# Supabase
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# FastAPI
FASTAPI_HOST=0.0.0.0
FASTAPI_PORT=8000
FASTAPI_DEBUG=True

# JWT
JWT_SECRET_KEY=your-secret-key-min-32-chars
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# WebSocket
WEBSOCKET_CORS_ORIGINS=http://localhost:3000

# Email (SendGrid)
SENDGRID_API_KEY=SG.xxx
SENDGRID_FROM_EMAIL=noreply@example.com
SENDGRID_FROM_NAME=Advertising Marketplace

# Frontend URL (–¥–ª—è email —Å—Å—ã–ª–æ–∫)
FRONTEND_URL=http://localhost:3000

# Redis (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=

# Background Tasks
ENABLE_BACKGROUND_TASKS=True
```

3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –≤ Supabase**:
   - –í—ã–ø–æ–ª–Ω–∏—Ç—å `supabase_migrations.sql` –≤ SQL Editor Supabase
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Supabase MCP –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π

4. **–ó–∞–ø—É—Å–∫ –±—ç–∫–µ–Ω–¥–∞**:
```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
python main.py

# –í–∞—Ä–∏–∞–Ω—Ç 2
uvicorn main:socket_app --reload --host 0.0.0.0 --port 8000

# –í–∞—Ä–∏–∞–Ω—Ç 3
./run_backend.sh
```

**–í–ê–ñ–ù–û**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `main:socket_app` (–Ω–µ `main:app`) –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ WebSocket!

5. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
curl http://localhost:8000/health
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"status": "healthy", "websocket_active_users": 0, ...}
```

### Frontend

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**:
```bash
cd frontend
npm install
# –∏–ª–∏
yarn install
```

2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ `.env.local`**:
```env
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_WS_URL=ws://localhost:8000
NEXT_PUBLIC_FRONTEND_URL=http://localhost:3000
NEXT_PUBLIC_APP_NAME=Advertising Marketplace
NEXT_PUBLIC_APP_VERSION=0.2.0
NEXT_PUBLIC_ENABLE_WEBSOCKET=true
NEXT_PUBLIC_ENABLE_EMAIL_NOTIFICATIONS=true
```

3. **–ó–∞–ø—É—Å–∫**:
```bash
npm run dev
# –∏–ª–∏
yarn dev
```

4. **–û—Ç–∫—Ä—ã—Ç—å**: http://localhost:3000

---

## üêõ –ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê 1: 404 –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞

**–°–∏–º–ø—Ç–æ–º—ã**:
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç "404 Page not found"
- WebSocket –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ (–≤–∏–¥–Ω–æ –≤ –ª–æ–≥–∞—Ö –±—ç–∫–µ–Ω–¥–∞)
- –¢–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage

**–ü—Ä–∏—á–∏–Ω–∞**:
- Race condition –º–µ–∂–¥—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º Zustand store –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º protected layouts
- `router.replace()` –≤ Next.js –Ω–µ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç –ø—Ä–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- Layouts –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `null` –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ `AuthInitializer` —É—Å–ø–µ–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å user

**–ü–æ–ø—ã—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏—è**:
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `AuthInitializer` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ user –∏–∑ localStorage
2. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ layouts (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –ø–µ—Ä–µ–¥ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º)
3. ‚úÖ –ó–∞–º–µ–Ω–µ–Ω `router.replace()` –Ω–∞ `window.location.href` –≤ `LoginForm.tsx`
4. ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞ –≤—Å–µ –µ—â–µ –æ—Å—Ç–∞–µ—Ç—Å—è**

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**:
- `LoginForm.tsx` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `window.location.href` –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞
- –í—Å–µ layouts –∏–º–µ—é—Ç —É–ª—É—á—à–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `AuthInitializer` –∑–∞–≥—Ä—É–∂–∞–µ—Ç user –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `AuthInitializer` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –î–û —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ layouts
2. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ middleware Next.js –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ layouts –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Zustand store –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–µ—Ä–µ–¥ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º
5. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `useRouter().push()` —Å `await` –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è

### ‚úÖ –†–ï–®–ï–ù–û: WebSocket 404 –æ—à–∏–±–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞**: `GET http://localhost:8000/socket.io/?EIO=4&transport=polling 404 (Not Found)`

**–†–µ—à–µ–Ω–∏–µ**:
1. –ò–∑–º–µ–Ω–µ–Ω `frontend/src/lib/socket.ts`:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `NEXT_PUBLIC_API_URL` (HTTP) –≤–º–µ—Å—Ç–æ `NEXT_PUBLIC_WS_URL` (WS)
   - –Ø–≤–Ω–æ —É–∫–∞–∑–∞–Ω `path: '/socket.io'`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã `transports: ['websocket', 'polling']`
2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `main.py`:
   - –í —Ä–µ–∂–∏–º–µ debug –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ `"main:socket_app"` –¥–ª—è reload
   - –í production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç `socket_app` –Ω–∞–ø—Ä—è–º—É—é

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ –†–ï–®–ï–ù–û: Supabase Client Initialization

**–ü—Ä–æ–±–ª–µ–º–∞**: `Client.__init__() got an unexpected keyword argument 'proxy'`

**–†–µ—à–µ–Ω–∏–µ**: –£–¥–∞–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `options={}` –∏–∑ `create_client()` –≤ `app/core/database.py`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ –†–ï–®–ï–ù–û: Backend Dependency Conflicts

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π `httpx`, `supabase`, `python-telegram-bot`

**–†–µ—à–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤–µ—Ä—Å–∏–∏ –≤ `requirements.txt`:
- `httpx==0.27.2`
- `supabase>=2.24.0`
- `websockets>=15.0.1`

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –ü–†–û–ï–ö–¢–ê

### ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

#### Backend (Phase 1 + Phase 2)
- ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (JWT, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—Ö–æ–¥, refresh tokens)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ (seller, channel owner)
- ‚úÖ –ú–æ–¥—É–ª—å –∫–∞–º–ø–∞–Ω–∏–π (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–∏–Ω—è—Ç–∏–µ, –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)
- ‚úÖ –ü–ª–∞—Ç–µ–∂–∏ (–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, –≤—ã–≤–æ–¥, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, escrow)
- ‚úÖ –û—Ç–∑—ã–≤—ã –∏ —Ä–µ–π—Ç–∏–Ω–≥–∏
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, —Å–ø–æ—Ä—ã, –≤—ã–≤–æ–¥—ã)
- ‚úÖ WebSocket –¥–ª—è real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (SendGrid)
- ‚úÖ –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (APScheduler)

#### Frontend (Phase 1.1 - 1.4)
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥
- ‚úÖ –ü—Ä–æ—Ñ–∏–ª–∏ (seller, channel owner)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏—è–º–∏
- ‚úÖ –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–∞–Ω–∞–ª–æ–≤
- ‚úÖ –ü–ª–∞—Ç–µ–∂–∏ (–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, –≤—ã–≤–æ–¥, –∏—Å—Ç–æ—Ä–∏—è)
- ‚úÖ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, —Å–ø–æ—Ä—ã, –≤—ã–≤–æ–¥—ã)
- ‚úÖ Real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (WebSocket)
- ‚úÖ –í—Å–µ —Ñ–æ—Ä–º—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π (React Hook Form + Zod)
- ‚úÖ Responsive –¥–∏–∑–∞–π–Ω (TailwindCSS)

### ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **404 –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞** ‚Äî —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ (—Å–º. –≤—ã—à–µ)
2. **Favicon 404** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ, –Ω–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞
3. **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** ‚Äî —Ç—Ä–µ–±—É—é—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SendGrid API key

### üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ

- –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å 404 –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞

---

## üß™ –¢–ï–°–¢–û–í–´–ï –î–ê–ù–ù–´–ï

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**Seller**:
- Email: `seller@test.com`
- Password: `seller123`
- User Type: `seller`

**Channel Owner**:
- Email: `channel@test.com`
- Password: `channel123`
- User Type: `channel_owner`

**Admin**:
- Email: `admin@test.com`
- Password: `admin123`
- User Type: `admin`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ü–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞—Ö–µ—à–∏—Ä–æ–≤–∞–Ω—ã –≤ –ë–î. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –∏—Ö –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ API `/auth/register` –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –≤ Supabase.

---

## üìù –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–¢–ö–ò

### Backend

1. **WebSocket**: –í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å `main:socket_app`, –Ω–µ `main:app`
2. **Supabase**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å service role key —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. **JWT**: Access token –∂–∏–≤–µ—Ç 30 –º–∏–Ω—É—Ç, refresh token ‚Äî 7 –¥–Ω–µ–π
4. **Email**: –¢—Ä–µ–±—É–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–π SendGrid API key –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º
5. **Background Tasks**: –í–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ `ENABLE_BACKGROUND_TASKS=False`

### Frontend

1. **Authentication**: –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Zustand store + localStorage (—Ç–æ–∫–µ–Ω—ã)
2. **WebSocket**: –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—Ö–æ–¥–µ —á–µ—Ä–µ–∑ `useWebSocket()` hook
3. **API Client**: Axios —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º JWT —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏
4. **Protected Routes**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç layouts –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
5. **Forms**: –í—Å–µ —Ñ–æ—Ä–º—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç React Hook Form + Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

1. **–ú–∏–≥—Ä–∞—Ü–∏–∏**: –í—ã–ø–æ–ª–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ `supabase_migrations.sql`
2. **–¢—Ä–∏–≥–≥–µ—Ä—ã**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `updated_at` –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
3. **–ò–Ω–¥–µ–∫—Å—ã**: –°–æ–∑–¥–∞–Ω—ã –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª–µ–π (user_id, campaign_id, etc.)
4. **RLS**: –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å 404 –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞

1. –î–æ–±–∞–≤–∏—Ç—å middleware Next.js –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
2. –£–ª—É—á—à–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –º–µ–∂–¥—É Zustand store –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º
3. –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
4. –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ server-side –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ user flows (seller, channel owner, admin)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–ª–∞—Ç–µ–∂–µ–π (—Ç–µ—Å—Ç–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –£–ª—É—á—à–µ–Ω–∏—è

1. –î–æ–±–∞–≤–∏—Ç—å RLS (Row Level Security) –≤ Supabase
2. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ (error boundaries)
3. –î–æ–±–∞–≤–∏—Ç—å loading states –¥–ª—è –≤—Å–µ—Ö async –æ–ø–µ—Ä–∞—Ü–∏–π
4. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (lazy loading, code splitting)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. –°–æ–∑–¥–∞—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é (Swagger —É–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `/docs`)
2. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ —Å–ª–æ–∂–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º
3. –°–æ–∑–¥–∞—Ç—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é (Vercel + Railway)

---

## üîó –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò

### Backend
- API Docs: http://localhost:8000/docs (Swagger UI)
- Health Check: http://localhost:8000/health
- WebSocket: ws://localhost:8000/socket.io

### Frontend
- Home: http://localhost:3000
- Login: http://localhost:3000/login
- Register: http://localhost:3000/register

### Supabase
- Dashboard: https://supabase.com/dashboard
- SQL Editor: https://supabase.com/dashboard/project/[project-id]/sql

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò –ü–û–î–î–ï–†–ñ–ö–ê

### –î–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

1. **–ü—Ä–æ—á–∏—Ç–∞—Ç—å —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é**
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** (–∑–∞–ø—É—Å—Ç–∏—Ç—å backend –∏ frontend)
3. **–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –ø—Ä–æ–±–ª–µ–º—É** (404 –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞)
4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Supabase MCP** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏** (backend –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, frontend –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞)

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

- `frontend/src/components/forms/LoginForm.tsx` ‚Äî –ª–æ–≥–∏–∫–∞ –ª–æ–≥–∏–Ω–∞
- `frontend/src/components/common/AuthInitializer.tsx` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è auth
- `frontend/src/app/(seller)/layout.tsx` ‚Äî protected layout –¥–ª—è seller
- `frontend/src/lib/store/auth.store.ts` ‚Äî Zustand store –¥–ª—è auth
- `app/core/websocket.py` ‚Äî WebSocket —Å–µ—Ä–≤–µ—Ä
- `main.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î–ê–ß–ò –ü–†–û–ï–ö–¢–ê

- [x] –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- [x] –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- [x] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- [x] –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É
- [x] –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è
- [x] –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- [x] –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- [x] –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏
- [x] –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
- [x] –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-11-15  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞**: 0.2.0-phase2  
**–°—Ç–∞—Ç—É—Å**: MVP + Phase 2 –∑–∞–≤–µ—Ä—à–µ–Ω—ã, —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 404 –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞

