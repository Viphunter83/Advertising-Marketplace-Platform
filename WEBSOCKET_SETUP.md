# üîå WebSocket Setup Guide

## –ü—Ä–æ–±–ª–µ–º–∞

–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ `404 (Not Found)` –¥–ª—è `/socket.io/`, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

## –†–µ—à–µ–Ω–∏–µ

### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å–∫–∞:
```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```
–≠—Ç–æ—Ç —Å–ø–æ—Å–æ–± **–ù–ï** –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç WebSocket, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ FastAPI `app`, –∞ –Ω–µ `socket_app`.

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –∑–∞–ø—É—Å–∫–∞:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Python (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
python main.py
```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ uvicorn —Å socket_app
```bash
uvicorn main:socket_app --reload --host 0.0.0.0 --port 8000
```

#### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑—É—è —Å–∫—Ä–∏–ø—Ç
```bash
./run_backend.sh
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –±—ç–∫–µ–Ω–¥–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Health check:**
   ```bash
   curl http://localhost:8000/health
   ```
   –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å `"websocket_active_users": 0` (–∏–ª–∏ –±–æ–ª—å—à–µ, –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)

2. **Socket.io endpoint:**
   ```bash
   curl http://localhost:8000/socket.io/?EIO=4&transport=polling
   ```
   –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç Socket.io (–Ω–µ 404)

3. **–í –±—Ä–∞—É–∑–µ—Ä–µ:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12)
   - –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –æ—à–∏–±–æ–∫ 404 –¥–ª—è `/socket.io/`
   - WebSocket –¥–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Frontend

Frontend —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
- `frontend/src/lib/socket.ts` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `http://localhost:8000` —Å `path: '/socket.io'`
- `frontend/.env.local` —Å–æ–¥–µ—Ä–∂–∏—Ç `NEXT_PUBLIC_API_URL=http://localhost:8000`

## Troubleshooting

### –ï—Å–ª–∏ WebSocket –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω —Å socket_app:**
   ```bash
   ps aux | grep uvicorn
   ```
   –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ—Ü–µ—Å—Å —Å `main:socket_app` –∏–ª–∏ `python main.py`

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞:**
   –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ Socket.io

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS:**
   –í `app/config.py` —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `WEBSOCKET_CORS_ORIGINS` –≤–∫–ª—é—á–∞–µ—Ç `http://localhost:3000`

4. **–û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞:**
   –ò–Ω–æ–≥–¥–∞ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (Ctrl+Shift+R)

